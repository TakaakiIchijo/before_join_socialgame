---
id: doc3
title: 2章:ソーシャルゲーム向けのUnityクライアント作成
sidebar_label: 2章:ソーシャルゲーム向けのUnityクライアント作成
---

Unityクライアントを作る時も、普通のゲーム同様気を付けることと、ソーシャルゲーム特有の気を付けることがあります。

特に後者を気にして書いていますが、既に知っている場合は読み飛ばして大丈夫です。

## チュートリアルを作ろう
**一言で言うとどんなもの？**

ユーザが操作説明を覚えるための専用シーン。かっこいいオープニングムービーを流したりもします。

と言うのが本来の流れですが、 **最近はAppStore審査で、ゲーム開始後すぐにアセットバンドルなどのデータダウンロードさせるゲームはリジェクトされます。**

なので、チュートリアルだけシーンを分けて、アセットバンドルダウンロード無しでチュートリアルまでは遊べるように考慮しておく事が必須です。

**これの理解や実装が不完全だと何が起きるの？**

- 開発終盤に地獄を見ます
- ユーザの初期離脱率がすごいことになります

**詳しく知りたい人は、この辺の単語でググってほしい**

- 情報求む
- 毎回死にそうになってます

## アウトゲームを作ろう

**一言で言うとどんなもの？**

インゲーム以外の部分を指します。ショップ、マイページ、プロフィール、クエスト、ガチャ、合成、etc…

つまり、ソーシャルゲームはメチャクチャにアウトゲーム領域が広いです。
その部分は **ゲームの世界観に合わせつつ、山ほどある画面UIを量産** する必要があります。

**これの理解や実装が不完全だと何が起きるの？**

- 画面量産でプレハブコンフリクトして死ぬ
- タップ連打でバグる
- 連続画面遷移でバグる

**詳しく知りたい人は、この辺の単語でググってほしい**

- 情報求む

### 楽しい多解像度、多アスペクト、ノッチ対応
一昔前は、世界がほとんど16:9のアスペクト比に統一されたかに見えました、幸せな時代でした…iPadも背景を一色置いて中身が16:9のままでも審査が通ったりしました。

最近は各社工夫を凝らしたノッチや、面白いアスペクト比の端末があります。iPad対応も割とちゃんと必要です。メチャクチャつらい…
最新のUnityであればDeviceSimulatorなどで見た目を確認できますが、Unityバージョンによってはノッチ対応用ライブラリや、アスペクト対応ライブラリを使って（あるいは作って）いきましょう。

デザイナーさんが親切であればアスペクト比やノッチの時はどういうレイアウトを想定しているか、の資料があるのでアスペクト比を切り替えたときの見た目を合わせれば大丈夫です。
そうでない場合は、頑張って良い感じに見えるようにしましょう。

アウトゲームは良い感じにシミュレーションして確認できますが、インゲームの面白さや有利不利がアスペクト比によって変わるようだと、一気に考えることが増えてきます。  
この文書ではインゲームについては触れませんが、メチャクチャ難しい要素があるので大変そうです。

### 多言語対応をしよう

Unity標準でlocalizationライブラリがUPM経由で提供されようとしています。
Google SpreadSheetからのインポートも出来そうなので、今後はこれを使うプロジェクトも出てくるかも知れません。
https://docs.unity3d.com/Packages/com.unity.localization@latest/

### UIライブラリの変遷
UnityはメジャーなUIライブラリが数年単位で切り替わってきています。なので参加したプロジェクトで何のUIライブラリを使っているかを確認して、同じライブラリを使いましょう。混在ダメ絶対！！！

#### NGUI期
Unity4.x系から続いているプロジェクトとかは大体これ。Unity標準のUIシステムが不評で、サードパーティー製アセットのNGUIが事実上標準でした。この作者は一体幾ら売り上げたんでしょうね…
さすがに今から新規で開発するプロジェクトではあまり採用されないかもしれませんが、CPU負荷が軽かったりして今も愛用している人やチームが居ます。

#### uGUI期
Unity4.6以降で標準UIとして提供されたuGUIです。おそらく、この文書を読んでいる皆さんのほとんどはuGUIを使っているのでは無いでしょうか。
ボタンのロングタップやダブルタップを受け付けるためのInputModule拡張をする場合もありますが、基本的にuGUIは技術書も日本語で出ているので、キャッチアップしやすいと思います。
プレハブコンフリクトを避けるために各パーツは小分けにしてResources.LoadしたりGameObject.Instanciate()して親子関係をスクリプトで付ける。みたいなコードがあちこちに散らばっていたらこれです。

#### 後期uGUI期
Unity2018.3以降はNestedPrefabという仕組みが出来ました。後期uGUIはuGUI期+NestedPrefabです。
uGUIを使ったアウトゲームGUIでも、NestedPrefabを**正しく**採用することでスクリプトの記述量を減らしつつ、プレハブコンフリクトも減らせたりします。

開発しているUnityバージョンにもよりますが、今から新規開発をするなら後期uGUIを採用していることが多い予感です。

#### UI Toolkit(旧名称:UI Elements)期
期待の新GUIシステムです。僕の周りではまだあまり採用例が無いのですが、1年後のリリースを見据えてるプロジェクトなどでは、使われているかも知れません。
特徴としてはEditorGUIも同じ書き方が出来ること、jQueryみたいなセレクタとcssみたいな修飾が出来ることです。

## 非同期通信がある場合のUI考え事

**一言で言うとどんなもの？**

スタンドアロンゲームと異なり、サーバ通信の結果が返ってくる時間は保証できません。
なので通信結果が連続でまとめて返ってくる場合や、10秒以上返ってこない場合に、ゲームが壊れないようにUI側で配慮する必要があります。

**これの理解や実装が不完全だと何が起きるの？**
- ダイアログが多重になる時に死ぬ
- 画面遷移後に前の画面の通信結果が返ってきて死ぬ
- バトル中に前の画面の通信結果が返ってきて死ぬ

**詳しく知りたい人は、この辺の単語でググってほしい**
- 情報求む

### ダイアログシステム
### 誤タップ防止とUIアニメーション
## 環境分けを作ろう
### DEV,STG,PROD
### InHouseBuildとDeploygate
## メジャーなライブラリを知ろう
### UniRx
### Zenject
### UniTask
