---
id: doc2
title: 1章:サーバサイドと仲良くなろう
sidebar_label: 1章:サーバサイドと仲良くなろう
---

## サーバサイドって何をしてるの
クライアントサイド、あるいは通信を含まないゲームを作っている人からすると、サーバサイドの人は「何か凄い事をやってる人！」という印象になりがちです。
**もちろん凄い事はやっているのですが** 一体どんなことを知っておくとサーバサイドの人、あるいはサーバと話が出来るようになるでしょうか。

正確な知識で言うと基本情報を勉強したり、ネットワーク通信の技術書を読むのが良いですが、この章は最低限、クライアント側が覚えておくと嬉しい事に絞って書いていきます。

## HTTP通信って何
### ヘッダ、ボディ、request、response
### 通信エラーのリトライ処理をしよう
### Jsonって何
### 通信が永続的か永続的じゃないか
いきなり永続的、と言われてもびっくりしてしまいますよね。
ネットワーク通信は、便宜上永続的なものと、永続的じゃないものがあります。  
永続的、というのは「送ったデータをサーバ側で受け取ったあと、サーバ側で常に保持する必要がある通信」だと思ってください。

例えば野球で考えると、ピッチャーが何球目にカーブを投げて、バッターはバットを1.67秒後に振り始めて1.92秒時点でバットに当たって二遊間を抜けて…
のような細かい情報は、全部サーバに保存していたらログが大変なことになってしまいます。


なので「巨人対阪神は6/20日の試合で4:1で決着」みたいな試合結果だけは永続的に保存しておこう。みたいな感じです。

リズムゲームだったら「この曲を難易度HARDで遊ぶ」「結果のスコアは4780点」みたいな通信は永続的です。

リアルタイム対戦系のゲームであれば、対戦中の様々な情報は大体が非永続的なデータで、試合結果だけが永続的、となります。
非永続的なデータはUNETだったりPHOTONだったりMONOBITだったり自前のリアルタイムサーバで処理して、永続的なデータだけはHTTP1.0のPOSTやGETで通信します。

リアルタイム対戦系のゲームではない場合は、ほとんど全てのサーバとの通信は永続的になります。
リアルタイム対戦系のゲームの場合は、　**この通信処理は永続的にすべきかどうか** 、を考えなければいけません。

tips:開発チームに参加したら **「このゲームってリアルタイム通信はありますか？」** と聞いてみましょう。無いということであれば、あなたが考えるべきことは、永続的な通信だけになります！


### 非永続のリアルタイム通信
上で説明したようにHTTP1.0の通信はヘッダ情報などの様々な追加データが載っている為、FPSのキャラ移動など秒間10回以上更新されるリアルタイム情報に使うにはオーバーヘッドが大きすぎます。
なので、FPSゲームなどではリアルタイム通信を永続的(HTTP1.0)ではない普通のUDPやTCPベースで通信します。後述するPhotonなどがこの方式です。

#### Photonか自社製か
#### マッチメイキング
### 暗号化通信(SSL通信)

## 認証って何
### 認証方式JWTとクッキー
### 匿名ログイン
### 認証を含むHTTP通信

### ソーシャルログインをしよう
ユーザがゲームを遊ぶ時の障壁を出来るだけ下げて、インストールして遊んでもらう人を増やす。というのがソーシャルゲームの大前提になります。
そのためには、ゲームの為だけに専用のメールアドレスとパスワードを登録してもらう、と言うのは相性が悪いです。

「とりあえずゲームを始めてもらう」ということであれば、上にあげた匿名ログインの仕組みによって実現できますが、そのままでは機種変更や（うっかりすると）再インストールなどの引継ぎが出来いという問題があります。

そのため、メールアドレスとパスワードではなく、多くのユーザが既に使っているサービスのアカウントを使ってゲームにログイン/登録できるようにする、というアイデアが生まれました。
これがソーシャルログインです。

現在において、日本国内で配信するゲームでよく検討されるのは
- Twitterログイン
- LINEログイン
- facebookログイン
- SignInWithApple
- GooglePlayServices

あたりです。クライアントエンジニアは実装の詳細を知る必要はありませんが、どういった事に気を付けておくと良いかを以下に書きます。

#### mBaasを使う
#### 自社基盤を作るか使う
##### SignInWithApple
##### GooglePlayServices
##### Twitter

## アプリバージョンアップをしよう
### チェックタイミング
### リソースバージョンとアプリバージョン

## 匿名ログイン

## IAP（アプリ内課金）
### レシート検証
### サブスクリプションの注意
